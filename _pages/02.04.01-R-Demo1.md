---
title: "R Demostration 1"
classes: wide
permalink: /data/r/demo1
sidebar:
  nav: "data"
---

In this demonstration, I will go over some basic R syntax as well as how to start utilizing some of the most popular R packages! Remember, all this functionality is completely free!

### Task: Download excel workbooks from the Bureau of Labor Statistics and clean them into one combined excel workbook.

We will start my downloading *four seperate* excel workbooks from the Bureau of Labor Statistics. Follow [this link](https://data.bls.gov/cgi-bin/surveymost?bls) and click the check boxes for the following labor data series indicators in the "Employment" section:

<p align="center">
  <img src="https://raw.githubusercontent.com/AndrewAFerrante/AndrewAFerrante.github.io/master/assets/images/BLS_4.PNG" alt="" width="400">
</p>

- Civilian Labor Force (Seasonally Adjusted) - LNS11000000
- Civilian Employment (Seasonally Adjusted) - LNS12000000
- Civilian Unemployment (Seasonally Adjusted) - LNS13000000
- Unemployment Rate (Seasonally Adjusted) - LNS14000000

Then scroll down to the bottom of the page and click "Retrieve data". <img src="https://raw.githubusercontent.com/AndrewAFerrante/AndrewAFerrante.github.io/master/assets/images/Retrieve_Data.PNG" class="img-responsive" alt="" width="80"> 

<p align="center">
<img src="https://raw.githubusercontent.com/AndrewAFerrante/AndrewAFerrante.github.io/master/assets/images/BLS_Download.png" class="img-responsive" alt="" width="350"> 
</p>

The next page will show you some tables of the four labor labor indicators you chose appear in nice little tables and allow for you to download each of the indicators into their own excel workbook. Download them all and take a quick look at what they currently look like.

<p align="center">
<img src="https://raw.githubusercontent.com/AndrewAFerrante/AndrewAFerrante.github.io/master/assets/images/Wide_Data.jpg" class="img-responsive" alt="" width="350"> 
</p>



#### Your task is to clean up these files so they only have two columns each: one for the date and another for their respective data.

Now, it is important to remember that you can accomplish this task by only using excel -> clicking and dragging on cells, rows, and colums to get the data to look like what you want. You do not need to use R to complete this task. Hoewver, if this is a routine task you need to do on a weekly or monthly basis, using R to automate this cleaning process will save you a lot of time and headache in the future. The purpose of "Beginner Coding for Excel Users" is to help Excel users quickly finish their tasks, and even automate them to save time in the future.

To continue, save them in their own folder somewhere with their own unique names. This is where I am going to save my files and what I am going to name them:

- C:\Users\Owner\Documents\Demo1
- Labor Force.xlsx
- Employment.xlsx
- Unemployment.xlsx
- Unemployment Rate.xlsx

I recommend you use the same file names and locations - this wil make things easier for us later.

Now open up RStudio. If you haven't installed R and RStudio to your machine before, I recommend you follow the instructions to do so [here](https://andrewaferrante.github.io/data/r/).

With RStudio open, you might see three distinct panels with different useful information. I recommend watching [this video](https://www.youtube.com/watch?v=FIrsOBy5k58) that explains what the different panels are for. 

Open a new "R Script" in File -> New File -> R Script. This is where we are going to write all of our code.

To start, we are going to need to import the excel workbooks into R. We will begin with using the "Labor Force.xlsx" data. You can import excel data to R by clicking through some prompts in the environment panel on the top right and clicking "Import Dataset", but for this demonstration, we are gonig to import by writing our own code.

In your new R Script, add the following code:
```
setwd('C:/Users/Owner/Documents/Demo1')
```
This function 'setwd()' sets the working directory we are going to be pulling excel data from and where we are going to write the new excel files to, after we finish our task. **It is good practice to set the working diretory every time you start a new project** You can always click through the prompts with the "Import Dataset" button, but this will take longer and fatigue us if we are importing muliple files at one time.

NOTE: within the 'setwd()' function, you need to have quotatoins around the file path you have your data in. Both single quotations ''' and double quorations '"' read the same in R, so use whichever you are more comfortable with. I will be using single quotations. Also, the backslashes in teh filepath 'C:\Users\Owner\Documents\Demo1' will need to be changed to **forward slashes** 'C:/Users/Owner/Documents/Demo1'. This is a common syntax error that will trip a lot of people up. 

After we set the correct working directory, we will need to import the data to R. To do this, we will need to install our first R package. 

Packages are their own unique groups of functions that can accomplish many different things. There are R packages out there that can simulate bird flying patterns, to play texas hold em poker, and even allow you to calculate baseball player statistics. In fact, there are over 10,000 R packages available for you to downlaod and play with!!! We do not need all 10,000 packages to be downloaded to our machine at one given time, so we will only use the ones we need, when we need them. To fuel your curosity, [here](https://cran.r-project.org/web/packages/available_packages_by_name.html) is where you can find all the official R packages. There are even unofficial packages listed elsewhere!

Think of each R package as one of the tabs you see in Microsoft Excel. You have some by default -> "Home", "Insert", and "Page Layout", but you can also add some additional ones like "Analyst ToolPak". Every R package is like it's own new Excel tab that includes its own unique features. 

Add the following line to your script to download the package we will use to import our Excel data to R:

```
install.packages('readxl')
```
If you get a ptompt that asks you to restart your R session, click yes - this will just insure the installiation is complete.


http://www.sthda.com/english/wiki/reading-data-from-excel-files-xls-xlsx-into-r

#How to run lines of code in an R Script!!!!

```
install.packages('readxl')
install.packages('writexl')
install.packages('dplyr')
install.packages('tidyr')
```




```
library(readxl)
library(writexl)
library(dplyr)
library(tidyr)
```
